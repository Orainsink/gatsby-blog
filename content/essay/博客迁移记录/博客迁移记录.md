---
title: 博客迁移记录
date: 2020-07-12 22:50:01
description: 记录博客从hexo迁移到gatsby的过程
tags: [随笔]
url:
categories: essay
---

> 工作稳定之后终于有闲心重写博客了. 原来的博客基于 Hexo, 优点是简单, 缺点是技术太落后. 重写博客的时候考虑了多种建站方式, 最后找到了最契合的静态网站生成器 gatsby. react 生态, 插件丰富, 社区活跃, 更新稳定, 真香~

## 博客历史

2018 wordpress 博客, 跟随网络教程照猫画虎搭建了最早的 wordpress 博客, 用来记一些鸡皮蒜毛的小事, 大概三个月过后不知道什么原因, 大概是因为本来用来翻墙的小 🐣 太弱鸡, 服务器密码太简单被别人随手黑了.

2018-2020 Hexo 博客, 轻量, 简单, 易维护, 主题美观, 可以挂在 gh-pages. Hexo 真的是非常适合小白的博客建站工具, 用了两年, 但是最近感觉可能 Hexo 有一些缺点我已经不能忍受了, 比如想加功能比较困难, 模板语法增加了额外的学习成本, 不是 SPA 用户体验较差, 以及 Hexo 太普遍, 身为前端, 如果博客都和别人一模一样, 就有点有失水准.

2020 ~ Gatsby 博客. 可以用来练手新技术, 同时挂在 github 里又不至于太 demo 太丢人, 可以说是相当理想的建站工具. 而且有一些做的比较好的博客可以参考, 避免我踩太多坑浪费时间. 996 的下班时间可是很宝贵的.

## 技术选择

- 静态网站生成器[gatsby](https://www.gatsbyjs.org/)

  Gatsby 是一个基于 React 的开源框架, 可用于快速构建静态网站, 拥有大量的拓展插件和模板. React 官方文档网站就基于 Gatsby.

  Gatsby 有官方提供的 blog starter, 省去了很多插件的安装步骤

- Graphql

  API 的查询语言, 和 restful API 不一样, Graphql 对前端更友好, 前端可以自己写查询语句, 获取自己想要的数据, 而不需要去和后端对接口, 效率提升极大. 很爽, 但是很难推行开来, 一般项目 API 层面的东西都是后端仔说了算, 让他们去重新设计表结构, 可能不如直接杀了他们. 只有在个人项目或者小型项目玩玩.

- [Antd 4.0](https://ant.design/) + TS + Less

  工作用的技术栈. 没别的意思, 学以致用.

- [React-three-fiber](https://github.com/react-spring/react-three-fiber)

  去年年初开坑的项目, 目前还有很多功能未完善, 但现在已经彻底改变了 three.js 的开发体验, 在用声明式的语法编写 three.js 代码的同时, 也兼容 three.js 的对象写法. 上手过后直呼爽到欲罢不能.

  原来在 react 中写 three.js 相当令人头痛, 基本上你需要在生命周期钩子函数内写一大坨一大坨的对象语法, 还要写一大堆 ref, 或者你需要把 three.js 的代码抽离成单独的 js 文件放在项目的其他位置, 给人的感觉你不是在写 react 而是在写 jquery. 这个库很好的解决了以上的问题, 你甚至可以将一个个 three.js 的对象拆分成一个个 jsx 的组件, 代码优雅, 降低了 three.js 的开发门槛

- [gsap](https://greensock.com/)

  老牌 js 动画库, 几乎万能. 引入这个库来实现一些 webGL 动画

## 优点

- SPA, 单页面引用, 用户体验比 Hexo 好得多.

- 首页 webGL, 很好的练习了 react-three-fiber 的使用方式, 而且还算炫. 深夜记笔记的时候可以提醒自己注意身体.
- 音乐播放器. 基于 howler 实现的音乐播放器, 考虑到移动端适配, 砍掉了一些无意义的功能. 最开始是引入的第三方播放器, 但是为了样式美观以及方便 redux 管理状态, 还是自己写比较好.
- SSR 和 SEO, 采用 gatsby 的 SSR 和 SEO 插件, 不过过程中踩了不少坑, 比如 window 对象报错, 或者 loadable 组件在 SSR 下报错之类的
- 图片优化, gatsby 的 `Image` 组件做过特殊封装, 在使用的时候, 会同时请求缩略图和正常大小的图片, 优化低网速情况下的用户体验.
- Antd 和 less, 通过 less 变量, 可以很方面地修改整个网站的 theme, 同时 antd 的组件可以提供比较好的交互体验.(比自己写好得多)
- Tarvis CI 集成, 挂载 github pages, cloudflare CDN 加速. 减少发布流程, push 到 master 后就可以不用管了. 同时为了提升访问速度, 做了自定义 cloudflare CDN 优化, 但是因为域名在国外, 且托管在 gh-pages, 所以效果有限.

## 待优化的点

- 目前的归档页始终不是很满意, 想做成时间线加分页
- 整体 css 样式需要统一一下并用 less 变量或者 css 变量替换掉, 有一些不合理的样式需要改掉, 但是我本身设计功底捉急, 比较头痛.
- markdown 的自定义 parse 样式需要修改, 目前是打算抄思否的样式.
- loadable 组件的 fallback 有一点 bug
- 考虑引入 hammer.js, 优化移动端 webgl 的交互
- 归档页的设计有问题, 需要改成 url search, 便于 SEO
- 为了兼容移动端导致布局不是很合理, 导致想塞功能的时候不知道塞到哪.
- 需要更多 SEO 方面的优化.

## 总结

虽然有这么多待优化的点, 但是我一个也不想做. 时间蛮少的, 还给自己定了一周两次无氧运动的目标, 过了半个月了, 一次也没完成, 还需要看算法, 再回顾前端基础之类的, 时间不够用啊, 还没有女朋友, 博客就这样吧, 将就用的了.
